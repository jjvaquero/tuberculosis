A1: code by Norberto Malpica, Juan Enrique Ortu√±o et al.
